# 条件扩散模型实现（MNIST手写数字生成）

---
🌐 **选择语言 / Select Language:**
- [English](README.md)
- [简体中文](README.zh_cn.md)
---

本仓库实现了一个**条件扩散模型**（Conditional Diffusion Model），可以看作是Stable Diffusion模型的极简教学版。模型使用经典的MNIST手写数字数据集进行训练，是本人个人学习的产物，希望发出来可以帮助更多初学者深入理解扩散模型的核心原理。🙂

## 模型特点

- **条件生成**: 支持根据数字标签（0-9）生成对应的手写数字图像
- **简化架构**: 基于U-Net的条件扩散模型，代码结构清晰易懂
- **完整实现**: 包含前向扩散、反向去噪、训练和生成全流程

## 核心组件

1. **扩散调度器**（Scheduler）：控制噪声添加过程
2. **时间步嵌入**（TimestepEmbedding）：将离散时间步转换为连续向量
3. **条件U-Net**：支持条件输入的特征提取网络
4. **训练管道**：完整的模型训练和损失计算

## 使用方法

```bash
# 训练模型
python main.py

# 生成数字（交互式）
# 输入0-9的数字标签，模型会生成对应的手写数字
```

`diffusion.pkl`包含一个已经训练过的模型，你可以运行`main.py`直接查看效果而无需训练。

## 注意事项

⚠️ **GPU支持**：如需使用GPU加速，请不要通过`requirements.txt`安装PyTorch，请从[Pytorch官网](https://pytorch.org)获取适合您CUDA版本的安装命令。

## 贡献

如果你觉得本仓库对你有帮助，烦请高抬贵手点一个免费的⭐。(\*^ω^\*)

## 许可证

本项目基于 MIT 许可证。详情请参阅 [LICENSE](LICENSE) 文件。
